<?php

use Illuminate\Database\Seeder;
use App\Blueprint;

class ExampleBlueprintSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        if (!Blueprint::where('name', '按照排名分配成績')->first()) {
            $b1 = new Blueprint;
            $b1->name = '按照排名分配成績';
            $b1->note = '輸入排名表與級距表，即可自動依排名分配成績';
            $b1->payload = json_decode('{"steps": {"step_1": {"name": "計算總人數", "type": "sql_select_map", "param": {"select": [{"as": "total", "expr": "COUNT(*)", "name": null, "type": "integer"}]}, "inputs": {"input": "student_ranks"}, "output": "step_1_result"}, "step_2": {"name": "帶入總人數", "note": "將總人數合併至 grade_interval 表，以便後續計算", "type": "sql_join", "param": {"method": "INNER JOIN"}, "inputs": {"left": "grade_interval", "right": "step_1_result"}, "output": "step_2_result"}, "step_3": {"name": "轉換百分比", "type": "sql_select_map", "param": {"select": [{"as": "grade_start", "expr": "grade_start", "type": "integer"}, {"as": "grade_end", "expr": "grade_end", "type": "integer"}, {"as": "percentage_start", "expr": "percentage_start", "type": "integer"}, {"as": "percentage_end", "expr": "percentage_end", "type": "integer"}, {"as": "total", "expr": "total", "type": "integer"}, {"as": "start", "expr": "percentage_start * total / 100", "name": null, "type": "integer"}, {"as": "end", "expr": "percentage_end * total / 100", "name": null, "type": "integer"}]}, "inputs": {"input": "step_2_result"}, "output": "step_3_result"}, "step_4": {"name": "合併學生排名", "type": "sql_join", "param": {"method": "LEFT JOIN", "conditions": [{"left": "ranking", "right": "start", "operator": ">"}, {"left": "ranking", "right": "end", "operator": "<="}]}, "inputs": {"left": "student_ranks", "right": "step_3_result"}, "output": "step_4_result"}, "step_5": {"name": "配分", "type": "sql_select_map", "param": {"select": [{"as": "ranking", "expr": "ranking", "type": "integer"}, {"as": "student_number", "expr": "student_number", "type": "varchar(255)"}, {"as": "grade", "expr": "grade_start - (((grade_start - grade_end) / (end - start)) * (ranking - start - 1))", "name": null, "type": "float"}]}, "inputs": {"input": "step_4_result"}, "output": "step_5_result"}}, "stepSeq": 5, "storages": {"step_1_result": {"name": "step_1_result", "type": "table", "schema": [{"name": "total", "type": "integer"}], "generated": true}, "step_2_result": {"name": "step_2_result", "type": "table", "schema": [{"name": "grade_start", "type": "integer"}, {"name": "grade_end", "type": "integer"}, {"name": "percentage_start", "type": "integer"}, {"name": "percentage_end", "type": "integer"}, {"name": "total", "type": "integer"}], "generated": true}, "step_3_result": {"name": "step_3_result", "type": "table", "schema": [{"name": "grade_start", "type": "integer"}, {"name": "grade_end", "type": "integer"}, {"name": "percentage_start", "type": "integer"}, {"name": "percentage_end", "type": "integer"}, {"name": "total", "type": "integer"}, {"name": "start", "type": "integer"}, {"name": "end", "type": "integer"}], "generated": true}, "step_4_result": {"name": "step_4_result", "type": "table", "schema": [{"name": "ranking", "type": "integer"}, {"name": "student_number", "type": "varchar(255)"}, {"name": "grade_start", "type": "integer"}, {"name": "grade_end", "type": "integer"}, {"name": "percentage_start", "type": "integer"}, {"name": "percentage_end", "type": "integer"}, {"name": "total", "type": "integer"}, {"name": "start", "type": "integer"}, {"name": "end", "type": "integer"}], "generated": true}, "step_5_result": {"name": "step_5_result", "type": "table", "schema": [{"name": "ranking", "type": "integer"}, {"name": "student_number", "type": "varchar(255)"}, {"name": "grade", "type": "float"}], "generated": true}, "student_ranks": {"name": "student_ranks", "type": "table", "schema": [{"name": "ranking", "type": "integer"}, {"name": "student_number", "type": "varchar(255)"}]}, "grade_interval": {"name": "grade_interval", "type": "table", "schema": [{"name": "grade_start", "type": "integer"}, {"name": "grade_end", "type": "integer"}, {"name": "percentage_start", "type": "integer"}, {"name": "percentage_end", "type": "integer"}]}}}', true);
            $b1->save();
        }
        if (!Blueprint::where('name', 'SMT 排課')->first()) {
            $b2 = new Blueprint;
            $b2->name = 'SMT 排課';
            $b2->note = '總共排四堂課的 SMT 範例';
            $b2->payload = json_decode('{"steps": {"step_1": {"name": "排課", "type": "smt", "param": {"content": "macro_declare_int_var_set (x1 x2 y1 y2)\nmacro_var_set_mutually_exclusive (x1 x2 y1 y2)\nmacro_var_set_in_ranges (x1 x2 y1 y2) [10 20] [25 30]\nmacro_var_set_not_equal_cross (x1 x2 y1 y2) [8 16 24]\n(assert (= x2 (+ x1 1)))\n(assert (= y2 (+ y1 1)))"}, "inputs": {"input": "smt_replacements"}, "output": "step_1_result"}}, "stepSeq": 1, "storages": {"step_1_result": {"name": "step_1_result", "type": "table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}], "generated": true}, "smt_replacements": {"name": "smt_replacements", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}]}}}', true);
            $b2->save();
        }

        if (!Blueprint::where('name', '書卷獎腳本')->first()) {
            $b3 = new Blueprint;
            $b3->name = '書卷獎腳本';
            $b3->note = '移植系計中計算書卷獎的程式';
            $b3->payload = json_decode('{"steps": {"step_1": {"name": "計算課程班排名名次表", "type": "sql_select_map", "param": {"select": [{"as": "scr_crsno", "expr": "scr_crsno", "type": "varchar(255)"}, {"as": "pcr_cname", "expr": "pcr_cname", "type": "varchar(255)"}, {"as": "std_stdcode", "expr": "std_stdcode", "type": "varchar(255)"}, {"as": "scr_score", "expr": "scr_score", "type": "integer"}, {"as": "ranking", "expr": "rank() over (partition by scr_crsno order by scr_score desc)", "name": null, "type": "integer"}]}, "inputs": {"input": "scores"}, "output": "step_1_result"}, "step_2": {"name": "濾掉非專業科目", "type": "sql_filter_by_semi_join", "param": {"column": "scr_crsno", "target": "scr_crsno", "operation": "in"}, "inputs": {"semi": "courses", "input": "step_1_result"}, "output": "step_2_result"}, "step_3": {"name": "算同課程中同排名人數", "type": "sql_group_by", "param": {"group": ["scr_crsno", "ranking"], "select": [{"as": "same_rank", "expr": "count(1)", "name": null, "type": "integer"}]}, "inputs": {"input": "step_2_result"}, "output": "step_3_result"}, "step_4": {"name": "計算各個課程的總人數與可配點數", "type": "sql_group_by", "param": {"group": ["scr_crsno"], "select": [{"as": "total_people", "expr": "count(1)", "name": null, "type": "integer"}, {"as": "total_points", "expr": "(count(1) / 5)", "name": null, "type": "integer"}]}, "inputs": {"input": "total_scores"}, "output": "step_4_result"}, "step_5": {"name": "課程排名帶入同排名人數", "type": "sql_join", "param": {"method": "LEFT JOIN", "conditions": [{"left": "scr_crsno", "right": "scr_crsno", "operator": "="}, {"left": "ranking", "right": "ranking", "operator": "="}]}, "inputs": {"left": "step_2_result", "right": "step_3_result"}, "output": "step_5_result"}, "step_6": {"name": "帶入課程配點與課程人數", "type": "sql_join", "param": {"method": "LEFT JOIN", "conditions": [{"left": "scr_crsno", "right": "scr_crsno", "operator": "="}]}, "inputs": {"left": "step_5_result", "right": "step_4_result"}, "output": "step_6_result"}, "step_7": {"name": "過濾掉修課人數 < 5 的課程", "type": "sql_filter_by_condition", "param": {"where": "total_people >= 5"}, "inputs": {"input": "step_6_result"}, "output": "step_7_result"}, "step_8": {"name": "配點", "type": "sql_select_map", "param": {"select": [{"as": "scr_crsno", "expr": "scr_crsno", "type": "varchar(255)"}, {"as": "pcr_cname", "expr": "pcr_cname", "type": "varchar(255)"}, {"as": "std_stdcode", "expr": "std_stdcode", "type": "varchar(255)"}, {"as": "scr_score", "expr": "scr_score", "type": "integer"}, {"as": "ranking", "expr": "ranking", "type": "integer"}, {"as": "same_rank", "expr": "same_rank", "type": "integer"}, {"as": "step_3_result_scr_crsno", "expr": "step_3_result_scr_crsno", "type": "varchar(255)"}, {"as": "step_3_result_ranking", "expr": "step_3_result_ranking", "type": "integer"}, {"as": "total_people", "expr": "total_people", "type": "integer"}, {"as": "total_points", "expr": "total_points", "type": "integer"}, {"as": "step_4_result_scr_crsno", "expr": "step_4_result_scr_crsno", "type": "varchar(255)"}, {"as": "get_point", "expr": "(     case ranking <= total_points when true     then (       case same_rank > (total_points - ranking + 1) when true        then (total_points - ranking + 1) / same_rank           else 1                                               end     )     else 0      end   ) + (     case ranking <= 3 when true     then 0.2     else 0.0      end   )", "name": null, "type": "float"}]}, "inputs": {"input": "step_7_result"}, "output": "step_8_result"}, "step_9": {"name": "點數總計", "type": "sql_group_by", "param": {"group": ["std_stdcode"], "select": [{"as": "points", "expr": "sum(get_point)", "name": null, "type": "float"}]}, "inputs": {"input": "step_8_result"}, "output": "step_9_result"}, "step_10": {"name": "合併所得點數", "type": "sql_join", "param": {"method": "INNER JOIN", "conditions": [{"left": "std_stdcode", "right": "std_stdcode", "operator": "="}]}, "inputs": {"left": "semester_ranking", "right": "step_9_result"}, "output": "step_10_result"}, "step_11": {"name": "非資工系學生", "type": "sql_filter_by_condition", "param": {"where": "scr_scorestatus != 1", "column": "std_stdcode", "operation": "not in"}, "inputs": {"input": "scores"}, "output": "step_11_result"}, "step_12": {"name": "濾掉非資工系", "type": "sql_filter_by_semi_join", "param": {"column": "std_stdcode", "target": "std_stdcode", "operation": "not in"}, "inputs": {"semi": "step_11_result", "input": "step_10_result"}, "output": "step_12_result"}, "step_13": {"name": "濾掉退課學生", "type": "sql_filter_by_semi_join", "param": {"column": "std_stdcode", "target": "std_stdcode", "operation": "not in"}, "inputs": {"semi": "withdraw", "input": "step_12_result"}, "output": "step_13_result"}, "step_14": {"name": "合併配點明細", "type": "sql_join", "param": {"method": "LEFT JOIN", "conditions": [{"left": "std_stdcode", "right": "std_stdcode", "operator": "="}]}, "inputs": {"left": "step_13_result", "right": "step_8_result"}, "output": "step_14_result"}, "step_15": {"name": "按點數排序", "type": "sql_order_by", "param": {"order": [{"column": "points", "direct": "desc"}]}, "inputs": {"input": "step_14_result"}, "output": "step_15_result"}}, "stepSeq": 15, "storages": {"scores": {"name": "scores", "type": "table", "schema": [{"name": "scr_year", "type": "integer"}, {"name": "scr_term", "type": "integer"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "crs_scoretype", "type": "integer"}, {"name": "crs_scoretype_text", "type": "varchar(255)"}, {"name": "pcr_pcrno", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_status", "type": "integer"}, {"name": "scr_scorestatus", "type": "integer"}, {"name": "scr_score", "type": "integer"}, {"name": "scr_score_level", "type": "varchar(255)"}, {"name": "scr_score_gpa", "type": "float"}, {"name": "trm_studystatus", "type": "integer"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}]}, "courses": {"name": "courses", "type": "table", "schema": [{"name": "scr_year", "type": "integer"}, {"name": "scr_term", "type": "integer"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "crs_scoretype", "type": "integer"}, {"name": "crs_scoretype_text", "type": "varchar(255)"}, {"name": "pcr_pcrno", "type": "varchar(255)"}, {"name": "crs_depno", "type": "varchar(255)"}]}, "withdraw": {"name": "withdraw", "type": "table", "schema": [{"name": "std_stdcode", "type": "varchar(255)"}, {"name": "std_cname", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "trm_groupno", "type": "varchar(255)"}, {"name": "trm_groupname", "type": "varchar(255)"}, {"name": "trm_class", "type": "varchar(255)"}, {"name": "scr_year", "type": "integer"}, {"name": "scr_term", "type": "integer"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "scr_scorestatus", "type": "integer"}, {"name": "scr_score", "type": "integer"}, {"name": "crs_scoretype", "type": "integer"}, {"name": "crs_scoretype_text", "type": "varchar(255)"}, {"name": "trm_studystatus", "type": "varchar(255)"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}, {"name": "identity_type", "type": "varchar(255)"}]}, "total_scores": {"name": "total_scores", "type": "table", "schema": [{"name": "scr_year", "type": "integer"}, {"name": "scr_term", "type": "integer"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "scr_scorestatus", "type": "integer"}, {"name": "scr_score", "type": "integer"}, {"name": "scr_score_level", "type": "varchar(255)"}, {"name": "scr_score_gpa", "type": "float"}, {"name": "crs_scoretype", "type": "integer"}, {"name": "crs_scoretype_text", "type": "varchar(255)"}]}, "step_1_result": {"name": "step_1_result", "type": "table", "schema": [{"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}], "generated": true}, "step_2_result": {"name": "step_2_result", "type": "table", "schema": [{"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}], "generated": true}, "step_3_result": {"name": "step_3_result", "type": "table", "schema": [{"name": "same_rank", "type": "integer"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "ranking", "type": "integer"}], "generated": true}, "step_4_result": {"name": "step_4_result", "type": "table", "schema": [{"name": "total_people", "type": "integer"}, {"name": "total_points", "type": "integer"}, {"name": "scr_crsno", "type": "varchar(255)"}], "generated": true}, "step_5_result": {"name": "step_5_result", "type": "table", "schema": [{"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}, {"name": "same_rank", "type": "integer"}, {"name": "step_3_result_scr_crsno", "type": "varchar(255)"}, {"name": "step_3_result_ranking", "type": "integer"}], "generated": true}, "step_6_result": {"name": "step_6_result", "type": "table", "schema": [{"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}, {"name": "same_rank", "type": "integer"}, {"name": "step_3_result_scr_crsno", "type": "varchar(255)"}, {"name": "step_3_result_ranking", "type": "integer"}, {"name": "total_people", "type": "integer"}, {"name": "total_points", "type": "integer"}, {"name": "step_4_result_scr_crsno", "type": "varchar(255)"}], "generated": true}, "step_7_result": {"name": "step_7_result", "type": "table", "schema": [{"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}, {"name": "same_rank", "type": "integer"}, {"name": "step_3_result_scr_crsno", "type": "varchar(255)"}, {"name": "step_3_result_ranking", "type": "integer"}, {"name": "total_people", "type": "integer"}, {"name": "total_points", "type": "integer"}, {"name": "step_4_result_scr_crsno", "type": "varchar(255)"}], "generated": true}, "step_8_result": {"name": "step_8_result", "type": "table", "schema": [{"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}, {"name": "same_rank", "type": "integer"}, {"name": "step_3_result_scr_crsno", "type": "varchar(255)"}, {"name": "step_3_result_ranking", "type": "integer"}, {"name": "total_people", "type": "integer"}, {"name": "total_points", "type": "integer"}, {"name": "step_4_result_scr_crsno", "type": "varchar(255)"}, {"name": "get_point", "type": "float"}], "generated": true}, "step_9_result": {"name": "step_9_result", "type": "table", "schema": [{"name": "points", "type": "float"}, {"name": "std_stdcode", "type": "varchar(255)"}], "generated": true}, "step_10_result": {"name": "step_10_result", "type": "table", "schema": [{"name": "std_stdcode", "type": "varchar(255)"}, {"name": "std_cname", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "trm_groupno", "type": "varchar(255)"}, {"name": "trm_groupname", "type": "varchar(255)"}, {"name": "trm_class", "type": "varchar(255)"}, {"name": "trm_studystatus", "type": "varchar(255)"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}, {"name": "identity_type", "type": "varchar(255)"}, {"name": "trm_year", "type": "varchar(255)"}, {"name": "trm_term", "type": "varchar(255)"}, {"name": "trm_termcount", "type": "varchar(255)"}, {"name": "score_avg", "type": "varchar(255)"}, {"name": "score_rank", "type": "varchar(255)"}, {"name": "points", "type": "float"}, {"name": "step_9_result_std_stdcode", "type": "varchar(255)"}], "generated": true}, "step_11_result": {"name": "step_11_result", "type": "table", "schema": [{"name": "scr_year", "type": "integer"}, {"name": "scr_term", "type": "integer"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "crs_scoretype", "type": "integer"}, {"name": "crs_scoretype_text", "type": "varchar(255)"}, {"name": "pcr_pcrno", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "std_stdcode", "type": "varchar(255)"}, {"name": "scr_status", "type": "integer"}, {"name": "scr_scorestatus", "type": "integer"}, {"name": "scr_score", "type": "integer"}, {"name": "scr_score_level", "type": "varchar(255)"}, {"name": "scr_score_gpa", "type": "float"}, {"name": "trm_studystatus", "type": "integer"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}], "generated": true}, "step_12_result": {"name": "step_12_result", "type": "table", "schema": [{"name": "std_stdcode", "type": "varchar(255)"}, {"name": "std_cname", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "trm_groupno", "type": "varchar(255)"}, {"name": "trm_groupname", "type": "varchar(255)"}, {"name": "trm_class", "type": "varchar(255)"}, {"name": "trm_studystatus", "type": "varchar(255)"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}, {"name": "identity_type", "type": "varchar(255)"}, {"name": "trm_year", "type": "varchar(255)"}, {"name": "trm_term", "type": "varchar(255)"}, {"name": "trm_termcount", "type": "varchar(255)"}, {"name": "score_avg", "type": "varchar(255)"}, {"name": "score_rank", "type": "varchar(255)"}, {"name": "points", "type": "float"}, {"name": "step_9_result_std_stdcode", "type": "varchar(255)"}], "generated": true}, "step_13_result": {"name": "step_13_result", "type": "table", "schema": [{"name": "std_stdcode", "type": "varchar(255)"}, {"name": "std_cname", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "trm_groupno", "type": "varchar(255)"}, {"name": "trm_groupname", "type": "varchar(255)"}, {"name": "trm_class", "type": "varchar(255)"}, {"name": "trm_studystatus", "type": "varchar(255)"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}, {"name": "identity_type", "type": "varchar(255)"}, {"name": "trm_year", "type": "varchar(255)"}, {"name": "trm_term", "type": "varchar(255)"}, {"name": "trm_termcount", "type": "varchar(255)"}, {"name": "score_avg", "type": "varchar(255)"}, {"name": "score_rank", "type": "varchar(255)"}, {"name": "points", "type": "float"}, {"name": "step_9_result_std_stdcode", "type": "varchar(255)"}], "generated": true}, "step_14_result": {"name": "step_14_result", "type": "table", "schema": [{"name": "std_stdcode", "type": "varchar(255)"}, {"name": "std_cname", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "trm_groupno", "type": "varchar(255)"}, {"name": "trm_groupname", "type": "varchar(255)"}, {"name": "trm_class", "type": "varchar(255)"}, {"name": "trm_studystatus", "type": "varchar(255)"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}, {"name": "identity_type", "type": "varchar(255)"}, {"name": "trm_year", "type": "varchar(255)"}, {"name": "trm_term", "type": "varchar(255)"}, {"name": "trm_termcount", "type": "varchar(255)"}, {"name": "score_avg", "type": "varchar(255)"}, {"name": "score_rank", "type": "varchar(255)"}, {"name": "points", "type": "float"}, {"name": "step_9_result_std_stdcode", "type": "varchar(255)"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "step_8_result_std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}, {"name": "same_rank", "type": "integer"}, {"name": "step_3_result_scr_crsno", "type": "varchar(255)"}, {"name": "step_3_result_ranking", "type": "integer"}, {"name": "total_people", "type": "integer"}, {"name": "total_points", "type": "integer"}, {"name": "step_4_result_scr_crsno", "type": "varchar(255)"}, {"name": "get_point", "type": "float"}], "generated": true}, "step_15_result": {"name": "step_15_result", "type": "table", "schema": [{"name": "std_stdcode", "type": "varchar(255)"}, {"name": "std_cname", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "trm_groupno", "type": "varchar(255)"}, {"name": "trm_groupname", "type": "varchar(255)"}, {"name": "trm_class", "type": "varchar(255)"}, {"name": "trm_studystatus", "type": "varchar(255)"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}, {"name": "identity_type", "type": "varchar(255)"}, {"name": "trm_year", "type": "varchar(255)"}, {"name": "trm_term", "type": "varchar(255)"}, {"name": "trm_termcount", "type": "varchar(255)"}, {"name": "score_avg", "type": "varchar(255)"}, {"name": "score_rank", "type": "varchar(255)"}, {"name": "points", "type": "float"}, {"name": "step_9_result_std_stdcode", "type": "varchar(255)"}, {"name": "scr_crsno", "type": "varchar(255)"}, {"name": "pcr_cname", "type": "varchar(255)"}, {"name": "step_8_result_std_stdcode", "type": "varchar(255)"}, {"name": "scr_score", "type": "integer"}, {"name": "ranking", "type": "integer"}, {"name": "same_rank", "type": "integer"}, {"name": "step_3_result_scr_crsno", "type": "varchar(255)"}, {"name": "step_3_result_ranking", "type": "integer"}, {"name": "total_people", "type": "integer"}, {"name": "total_points", "type": "integer"}, {"name": "step_4_result_scr_crsno", "type": "varchar(255)"}, {"name": "get_point", "type": "float"}], "generated": true}, "semester_ranking": {"name": "semester_ranking", "type": "table", "schema": [{"name": "std_stdcode", "type": "varchar(255)"}, {"name": "std_cname", "type": "varchar(255)"}, {"name": "trm_depno", "type": "varchar(255)"}, {"name": "trm_depname", "type": "varchar(255)"}, {"name": "trm_groupno", "type": "varchar(255)"}, {"name": "trm_groupname", "type": "varchar(255)"}, {"name": "trm_class", "type": "varchar(255)"}, {"name": "trm_studystatus", "type": "varchar(255)"}, {"name": "trm_studystatus_text", "type": "varchar(255)"}, {"name": "identity_type", "type": "varchar(255)"}, {"name": "trm_year", "type": "varchar(255)"}, {"name": "trm_term", "type": "varchar(255)"}, {"name": "trm_termcount", "type": "varchar(255)"}, {"name": "score_avg", "type": "varchar(255)"}, {"name": "score_rank", "type": "varchar(255)"}]}}}', true);
            $b3->save();
        }

        if (!Blueprint::where('name', '系計中排課系統整合')->first()) {
            $b4 = new Blueprint;
            $b4->name = '系計中排課系統整合';
            $b4->note = '每個年級分開排課';
            $b4->payload = json_decode('{"steps": {"step_1": {"name": "排大一必修課", "type": "smt", "param": {"content": "macro_declare_int_var_set ($vars)\nmacro_var_set_mutually_exclusive ($vars)\nmacro_var_set_in_ranges ($vars) [10 18] [30 34]\nmacro_var_set_not_equal_cross ($vars) [$excludes]"}, "inputs": {"input": "replacements_1"}, "output": "step_1_result"}, "step_2": {"name": "排大二必修課", "type": "smt", "param": {"content": "macro_declare_int_var_set ($vars)\nmacro_var_set_mutually_exclusive ($vars)\nmacro_var_set_in_ranges ($vars) [10 18] [30 34]\nmacro_var_set_not_equal_cross ($vars) [$excludes]"}, "inputs": {"input": "replacements_2"}, "output": "step_2_result"}, "step_3": {"name": "排大三必修課", "type": "smt", "param": {"content": "macro_declare_int_var_set ($vars)\nmacro_var_set_mutually_exclusive ($vars)\nmacro_var_set_in_ranges ($vars) [10 18] [30 34]\nmacro_var_set_not_equal_cross ($vars) [$excludes]"}, "inputs": {"input": "replacements_3"}, "output": "step_3_result"}, "step_4": {"name": "排大四必修課", "type": "smt", "param": {"content": "macro_declare_int_var_set ($vars)\nmacro_var_set_mutually_exclusive ($vars)\nmacro_var_set_in_ranges ($vars) [10 18]\nmacro_var_set_not_equal_cross ($vars) [$excludes]"}, "inputs": {"input": "replacements_4"}, "output": "step_4_result"}, "step_5": {"name": "排研究所必修課", "type": "smt", "param": {"content": "macro_declare_int_var_set ($vars)\nmacro_var_set_mutually_exclusive ($vars)\nmacro_var_set_in_ranges ($vars) [1 34]\nmacro_var_set_not_equal_cross ($vars) [19 20 21 22 23 24 25 26 27 29]\nmacro_var_set_not_equal_cross ($vars) [$excludes]"}, "inputs": {"input": "replacements_5"}, "output": "step_5_result"}}, "stepSeq": 5, "storages": {"step_1_result": {"name": "step_1_result", "type": "table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}], "generated": true}, "step_2_result": {"name": "step_2_result", "type": "table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}], "generated": true}, "step_3_result": {"name": "step_3_result", "type": "table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}], "generated": true}, "step_4_result": {"name": "step_4_result", "type": "table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}], "generated": true}, "step_5_result": {"name": "step_5_result", "type": "table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}], "generated": true}, "replacements_1": {"name": "replacements_1", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}]}, "replacements_2": {"name": "replacements_2", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}]}, "replacements_3": {"name": "replacements_3", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}]}, "replacements_4": {"name": "replacements_4", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}]}, "replacements_5": {"name": "replacements_5", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}]}}}', true);
            $b4->save();
        }
    }
}
