<?php

use Illuminate\Database\Seeder;
use App\Blueprint;

class ExampleBlueprintSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $b1 = new Blueprint;
        $b1->name = '範例：按照排名分配成績';
        $b1->note = '輸入排名表與級距表，即可自動依排名分配成績';
        $b1->payload = json_decode('{"steps": {"ClCvmOde": {"name": "轉換百分比", "type": "sql_select_map", "param": {"select": [{"as": "grade_start", "expr": "ixMlU1pB_grade_start", "type": "integer"}, {"as": "grade_end", "expr": "ixMlU1pB_grade_end", "type": "integer"}, {"as": "percentage_start", "expr": "ixMlU1pB_percentage_start", "type": "integer"}, {"as": "percentage_end", "expr": "ixMlU1pB_percentage_end", "type": "integer"}, {"as": "start", "expr": "ixMlU1pB_percentage_start * Xr4W3xOx_result_total / 100", "type": "integer"}, {"as": "end", "expr": "ixMlU1pB_percentage_end * Xr4W3xOx_result_total / 100", "type": "integer"}]}, "inputs": {"input": "P6KgjQus_result"}, "output": "ClCvmOde_result"}, "P6KgjQus": {"name": "帶入課程人數", "type": "sql_join", "param": {"method": "INNER JOIN"}, "inputs": {"left": "ixMlU1pB", "right": "Xr4W3xOx_result"}, "output": "P6KgjQus_result"}, "S28J1Eed": {"name": "合併學生排名", "type": "sql_join", "param": {"method": "LEFT JOIN", "conditions": [{"left": "rank", "right": "start", "operator": ">"}, {"left": "rank", "right": "end", "operator": "<="}]}, "inputs": {"left": "nxHNiEi5", "right": "ClCvmOde_result"}, "output": "S28J1Eed_result"}, "Xr4W3xOx": {"name": "計算總人數", "type": "sql_select_map", "param": {"select": [{"as": "total", "expr": "COUNT(*)", "type": "integer"}]}, "inputs": {"input": "nxHNiEi5"}, "output": "Xr4W3xOx_result"}, "q5uh8nQs": {"name": "配分", "type": "sql_select_map", "param": {"select": [{"as": "rank", "expr": "nxHNiEi5_rank", "type": "integer"}, {"as": "student_number", "expr": "nxHNiEi5_student_number", "type": "varchar(255)"}, {"as": "grade", "expr": "ClCvmOde_result_grade_start - (((ClCvmOde_result_grade_start - ClCvmOde_result_grade_end) / (ClCvmOde_result_end - ClCvmOde_result_start)) * (nxHNiEi5_rank - ClCvmOde_result_start - 1))", "type": "float"}]}, "inputs": {"input": "S28J1Eed_result"}, "output": "q5uh8nQs_result"}}, "storages": {"ixMlU1pB": {"name": "分數級距分配表", "type": "table", "schema": [{"name": "grade_start", "type": "integer"}, {"name": "grade_end", "type": "integer"}, {"name": "percentage_start", "type": "integer"}, {"name": "percentage_end", "type": "integer"}]}, "nxHNiEi5": {"name": "學生排名", "type": "table", "schema": [{"name": "rank", "type": "integer"}, {"name": "student_number", "type": "varchar(255)"}]}, "ClCvmOde_result": {"name": "轉換百分比的結果", "type": "table", "schema": [{"name": "grade_start", "type": "integer"}, {"name": "grade_end", "type": "integer"}, {"name": "percentage_start", "type": "integer"}, {"name": "percentage_end", "type": "integer"}, {"name": "start", "type": "integer"}, {"name": "end", "type": "integer"}], "generated": true}, "P6KgjQus_result": {"name": "帶入課程人數的結果", "type": "table", "schema": [{"name": "ixMlU1pB_grade_start", "type": "integer"}, {"name": "ixMlU1pB_grade_end", "type": "integer"}, {"name": "ixMlU1pB_percentage_start", "type": "integer"}, {"name": "ixMlU1pB_percentage_end", "type": "integer"}, {"name": "Xr4W3xOx_result_total", "type": "integer"}], "generated": true}, "S28J1Eed_result": {"name": "合併學生排名的結果", "type": "table", "schema": [{"name": "nxHNiEi5_rank", "type": "integer"}, {"name": "nxHNiEi5_student_number", "type": "varchar(255)"}, {"name": "ClCvmOde_result_grade_start", "type": "integer"}, {"name": "ClCvmOde_result_grade_end", "type": "integer"}, {"name": "ClCvmOde_result_percentage_start", "type": "integer"}, {"name": "ClCvmOde_result_percentage_end", "type": "integer"}, {"name": "ClCvmOde_result_start", "type": "integer"}, {"name": "ClCvmOde_result_end", "type": "integer"}], "generated": true}, "Xr4W3xOx_result": {"name": "計算總人數的結果", "type": "table", "schema": [{"name": "total", "type": "integer"}], "generated": true}, "q5uh8nQs_result": {"name": "配分的結果", "type": "table", "schema": [{"name": "rank", "type": "integer"}, {"name": "student_number", "type": "varchar(255)"}, {"name": "grade", "type": "float"}], "generated": true}}}', true);
        $b1->save();

        $b2 = new Blueprint;
        $b2->name = '範例：排課';
        $b2->note = '總共排五堂課的範例';
        $b2->payload = json_decode('{"steps": {"J8qmJ9Wo": {"name": "排課 SMT", "type": "smt", "param": {"content": "macro_declare_int_var_set (a1 a2 a3 b1 b2 b3 c1 c2 c3 d1 d2 d3 e1 e2 e3)\nmacro_var_set_mutually_exclusive (a1 a2 a3 b1 b2 b3 c1 c2 c3)\nmacro_var_set_mutually_exclusive (d1 d2 d3 e1 e2 e3 a1 a2 a3)\nmacro_var_set_in_ranges (a1 a2 a3 b1 b2 b3 c1 c2 c3) [10 13] [20 25] [30 35]\nmacro_var_set_in_ranges (d1 d2 d3 e1 e2 e3) [10 13] [20 25] [40 45]\n(assert (= a2 (+ a1 1)))\n(assert (= a3 (+ a2 1)))\n(assert (= b2 (+ b1 1)))\n(assert (= c2 (+ c1 1)))\n(assert (= d2 (+ d1 1)))\n(assert (= e2 (+ e1 1)))", "varList": []}, "inputs": {"input": "8xLn5uxd"}, "output": "J8qmJ9Wo_result"}}, "storages": {"8xLn5uxd": {"name": "指定課表", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}]}, "J8qmJ9Wo_result": {"name": "排課 SMT的結果", "type": "smt_variable_table", "schema": [{"name": "variable", "type": "varchar(255)"}, {"name": "value", "type": "varchar(255)"}], "generated": true}}}', true);
        $b2->save();
    }
}
